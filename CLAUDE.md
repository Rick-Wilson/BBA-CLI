# Claude Code Instructions for BBA-CLI

## Windows VM Access via SSH

The EPBot DLLs are Windows-only. To run BBA/EPBot commands, use SSH to connect to the Windows VM running under Parallels.

### SSH Runner

Use the ssh_runner.py from Practice-Bidding-Scenarios:

```python
import os
os.environ['WINDOWS_HOST'] = '10.211.55.5'
os.environ['WINDOWS_USER'] = 'Rick'

import sys
sys.path.insert(0, '/Users/rick/Development/GitHub/Practice-Bidding-Scenarios/build-scripts-mac')
from ssh_runner import run_windows_command, mac_to_windows_path

# Example: Run a Windows command
returncode, stdout, stderr = run_windows_command('dir G:\\BBA-CLI', check=False)
print(stdout)
```

The ssh_runner automatically maps the network drives before each command using `net use`.

### Drive Mappings

The Windows VM has shared folders mapped to local GitHub repositories:

| Windows Drive | Mac Path | UNC Path |
|--------------|----------|----------|
| `G:` | `/Users/rick/Development/GitHub` | `\\Mac\Home\Development\GitHub` |
| `P:` | `/Users/rick/Development/GitHub/Practice-Bidding-Scenarios` | `\\Mac\Home\Development\GitHub\Practice-Bidding-Scenarios` |
| `S:` | `~/Documents/BCScript/2024-11-13` | `\\Mac\Home\Documents\BCScript\2024-11-13` |

So BBA-CLI is at `G:\BBA-CLI` on Windows.

### Convention Files

Convention card files (.bbsa) are located at:
- Mac: `/Users/rick/Development/GitHub/Practice-Bidding-Scenarios/bbsa/`
- Windows: `P:\bbsa\`

The default convention for testing is `21GF-DEFAULT.bbsa`.

### Running EPBot Wrapper

The epbot-wrapper is a .NET application that wraps the EPBot DLL:

```bash
# Build the wrapper
run_windows_command(r'cd /d G:\BBA-CLI\epbot-wrapper && dotnet build -c Release -o G:\BBA-CLI\dist\epbot-wrapper')

# Run with JSON input
run_windows_command(r'cd /d G:\BBA-CLI\dist\epbot-wrapper && type input.json | epbot-wrapper.exe')
```

Or in interactive mode:
```cmd
epbot-wrapper.exe --interactive
```

### Integration Tests

Test files are in `G:\BBA-CLI\integration-tests\`:
- `1N.pbn` - 500 deals where South should open 1NT
- `batch-request.json` - JSON input for epbot-wrapper
- `batch-response.json` - JSON output from epbot-wrapper
- `1N-output.pbn` - Converted PBN output

Expected results are in `P:\bba\1N.pbn` (generated by BBA.exe GUI).
